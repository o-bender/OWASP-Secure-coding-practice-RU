# OWASP Secure Coding Practices Quick Reference Guide
OWASP Secure coding practice (russian translate)

## Introduction


## Проверка входящих данных
- [ ] Проводить проверку всех данных в доверенной системе (на сервере)
- [ ] Определить все источники данных и разделить их на доверенные и недоверенные. Проверять всех данные из 
     недоверенных источников (базы данных, файловые потоки и т.п.)
- [ ] Для приложения должна существовать централизованная процедура проверки ввода
- [ ] Определите корректные наборы символов, такие как UTF-8, для всех источников ввода
- [ ] Кодируйте данные в общий набор символов перед проверкой
- [ ] Все ошибки проверки должны приводить к отклонению входных данных
- [ ] Определите, поддерживает ли система расширенные наборы символов UTF-8, и если да, 
     проверьте правильность декодирования UTF-8
- [ ] Перед обработкой проверьте все предоставленные клиентом данные, включая все параметры, 
     URL-адреса и содержимое заголовка HTTP (например, имена и значения файлов Cookie). 
     Обязательно включите autopostback в JavaScript, Flash или другом встраиваемом коде
- [ ] Убедитесь, что значения заголовка в запросах и ответах содержат только символы ASCII
- [ ] Проверяйте данные из перенаправлений (злоумышленник может отправить вредоносный контент 
     непосредственно во время перенаправления, что позволяет обойти логику приложения и любую проверку,
     выполненную перед перенаправлением)
- [ ] Проверяйте типы данных
- [ ] Проверяйте диапазоны данных
- [ ] Проверяйте размер данных
- [ ] Когда это возможно, проверяйте все входные данные по «белому» списку разрешенных символов
- [ ] Если какие-либо потенциально опасные символы должны быть разрешены в качестве входных данных, 
     убедитесь, что вы внедрили дополнительные элементы управления, такие как выходное кодирование,
     безопасные API для конкретных задач и учет использования этих данных в приложении. 
     Пример опасных символов: <> "'% () & + \ \' \"
- [ ] Если ваша стандартная процедура проверки не может адресовать следующие входные данные, то они
     должны проверяться дискретно:
     - [ ] Проверьте на нулевой байт (%00)
     - [ ] Проверьте на символы новой строки (%0d, %0a, \r, \n)
     - [ ] Проверьте на символы изменения пути “dot-dot-slash" (../ или ..\). В тех случаях, когда поддерживается 
     расширенная кодировка UTF-8, обратитесь к альтернативному представлению, например: %c0%ae%c0%ae/
     (Используйте канонизацию для устранения двойного кодирования или других форм обфускаций)
     
## Выходное кодирование
- [ ] Проводить все кодирования в доверенной системе (на сервере)
- [ ] Используйте стандартную, проверенную процедуру кодировки для каждого типа
- [ ] Contextually output encode all data returned to the client that originated outside the application's trust
boundary. HTML entity encoding is one example, but does not work in all cases
- [ ] Кодируйте все символы, если не известно, что они безопасны для предполагаемого интерпретатора
- [ ] Очищайте выходные данные в контексте среды выполнения запросов данных (SQL, XML, and LDAP). 
     Т.е. удаляйте и или кодируйте недопустимные символы в запросах относительно конкретной среды их выполнения.
     Кавычки для SQL. Символы <, > для XML. Если они не будут экранированы, то это иньекция.   
- [ ] Очищайте весь вывод ненадежных данных командам операционной системы

## Аутентификация и управление паролями
- [ ] Требуйте аутентификацию для всех страниц и ресурсов кроме специально определённых как публичные
- [ ] Все аутентификационные параметры должны быть проверены и применены в доверенной системе (на сервере).
     Т.е. лишние параметры не надо передовать.
- [ ] Когда это возможно создавйте и используйте стандартные, проверенные службы аутентификации
- [ ] Используйте централизованную реализацию для всех элементов управления проверкой подлинности, 
     включая библиотеки, которые вызывают внешние службы проверки подлинности.
- [ ] Отделите логику аутентификации от запрашиваемого ресурса и используйте перенаправление "в" и "из"
     централизованного контроля аутентификации
- [ ] Все элементы управления аутентификацией должны быть безопасными
- [ ] Все функции администрирования и управления учетными записями должны быть как минимум такими же безопасными, 
     как и основной механизм аутентификации
- [ ] Если ваше приложение управляет хранилищем учетных данных, оно должно обеспечить хранение только криптографически 
     надежных односторонних хэшированных паролей и чтобы таблица / файл, в котором хранятся пароли и ключи, была 
     доступна для записи только приложению. (Не используйте алгоритм MD5, если его можно избежать)
- [ ] Хеширование пароля должно быть реализовано в доверенной системе (например, на сервере).
- [ ] Проверяйте данные аутентификации только после завершения ввода всех данных, особенно для последовательной 
     реализации аутентификации
- [ ] Ответы об ошибках аутентификации не должны указывать, какая часть данных аутентификации была неправильной. 
     Например, вместо «Неверное имя пользователя» или «Неверный пароль», просто используйте 
     «Неверное имя пользователя и / или пароль» для обоих. Ответы об ошибках должны быть действительно идентичны
     как в отображении, так и в исходном коде
- [ ] Используйте аутентификацию для подключений к внешним системам, которые содержат конфиденциальную информацию или функции
- [ ] Учетные данные аутентификации для доступа к службам, внешним по отношению к приложению, должны быть зашифрованы
     и сохранены в защищенном месте в доверенной системе (например, на сервере). Исходный код НЕ является безопасным местом
- [ ] Используйте только HTTP POST-запросы для передачи аутентификационных данных
- [ ] Отправляйте не временные пароли только через зашифрованное соединение или в виде зашифрованных данных, 
     например, в зашифрованном электронном письме. Временные пароли, связанные с сбросом пароля электронной почты, 
     могут быть исключением
- [ ] Обеспечьте соблюдение требований к сложности пароля, установленных политикой или правилами. Учетных данных 
     аутентификации должно быть достаточно, чтобы противостоять атакам, типичным для угроз в развернутой среде. 
     (например, требующий использования буквенных, а также цифровых и/или специальных символов)
- [ ] Обеспечить соблюдение требований к длине пароля, установленных политикой или правилами. Восемь символов обычно 
     используются, но 16 лучше или рассмотрите использование словосочетаний (на пример из нескольких слов разделённых пробелом)
- [ ] Ввод пароля должен быть скрыт на экране пользователя. (например, в веб-формах используйте тип ввода «password»)
- [ ] Принудительно отключайте учетную запись после установленного количества недопустимых попыток входа в систему 
     (обычно пять попыток). Учетная запись должна быть отключена на период времени, достаточный для предотвращения
     подбора учетных данных методом подбора, но не настолько, чтобы можно было выполнить атаку типа
     «отказ в обслуживании».
- [ ] Операции сброса и изменения пароля требуют такого же уровня контроля, как создание учетной записи и аутентификация.
- [ ] Вопросы для сброса пароля должны поддерживать достаточно случайные ответы. 
     (например, «любимая книга» - плохой вопрос, потому что «Библия» - очень распространенный ответ)
- [ ] При использовании сброса по электронной почте отправляйте только электронную почту на предварительно 
     зарегистрированный адрес с временной ссылкой или паролем.
- [ ] Временные пароли и ссылки должны иметь короткий срок действия
- [ ] Принудительно менять временные пароли при следующем использовании
